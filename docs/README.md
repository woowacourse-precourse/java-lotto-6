# 📋 기능 설계서

## 🚀 로또 게임 규칙

로또 게임은 아래와 같은 규칙으로 진행된다.

```
- 로또 번호의 숫자 범위는 1~45까지이다.
- 1개의 로또를 발행할 때 중복되지 않는 6개의 숫자를 뽑는다.
- 당첨 번호 추첨 시 중복되지 않는 숫자 6개와 보너스 번호 1개를 뽑는다.
- 당첨은 1등부터 5등까지 있다. 당첨 기준과 금액은 아래와 같다.
    - 1등: 6개 번호 일치 / 2,000,000,000원
    - 2등: 5개 번호 + 보너스 번호 일치 / 30,000,000원
    - 3등: 5개 번호 일치 / 1,500,000원
    - 4등: 4개 번호 일치 / 50,000원
    - 5등: 3개 번호 일치 / 5,000원
```

* 로또 구입 금액을 입력하면 구입 금액에 해당하는 만큼 로또를 발행해야 한다.
* 로또 1장의 가격은 1,000원이다.
* 당첨 번호와 보너스 번호를 입력받는다.
* 사용자가 구매한 로또 번호와 당첨 번호를 비교하여 당첨 내역 및 수익률을 출력하고 로또 게임을 종료한다.

## 🧙🏻 MVC 패턴(?)에 따른 기능 목록

### 🎮 service

#### **로또 게임 서비스**

로또 게임의 비즈니스 로직을 수행합니다.

로또 구매자와 로또 판매점을 통해 로또 게임을 진행합니다.

* 로또 게임 진행 순서

1. 사용자로부터 로또를 구입할 금액을 입력 받습니다.
2. 입력 받은 금액으로 로또 판매점에서 로또를 구매합니다.
    * 구매한 로또 개수와 목록을 출력합니다.
3. 사용자로부터 당첨 번호, 보너스 번호를 입력 받습니다.
4. 입력받은 당첨 번호, 보너스 번호를 본인이 구매한 로또 번호와 비교하여 당첨 개수 통계와 수익률을 계산합니다.
    * 계산한 당첨 개수 통계와 수익률을 출력합니다.

### 🖼️ view

#### InputView (고정된 기능을 하는 클래스)

사용자로부터 **직접** 입력을 받아오는 역할을 하는 클래스입니다.

* 구입 금액 입력 받기
    * [x] `구입금액을 입력해 주세요.`를 출력합니다.
    * [x] `camp.nextstep.edu.missionutils.Console.readLine()`을 이용하여 입력받습니다.
* 당첨 번호 입력 받기
    * [x] `당첨 번호를 입력해 주세요.`를 출력합니다.
    * [x] `camp.nextstep.edu.missionutils.Console.readLine()`을 이용하여 입력받습니다.
* 보너스 번호 입력 받기
    * [x] `보너스 번호를 입력해 주세요.`를 출력합니다.
    * [x] `camp.nextstep.edu.missionutils.Console.readLine()`을 이용하여 입력받습니다.

#### OutputView (고정된 기능을 하는 클래스)

사용자에게 원하는 결과를 출력하는 역할을 하는 클래스입니다.

출력되는 화면의 내용 중, 업데이트 되는 영역과 업데이트 되지 않는 영역을 따로 관리합니다.

예를 들어 아래가 사용자에게 보여질 화면의 예시라고 하면

```
8개를 구매했습니다.
[8, 21, 23, 41, 42, 43] 
[3, 5, 11, 16, 32, 38] 
[7, 11, 16, 35, 36, 44] 
[1, 8, 11, 31, 41, 42] 
[13, 14, 16, 38, 42, 45] 
[7, 11, 30, 40, 42, 43] 
[2, 13, 22, 32, 38, 45] 
[1, 3, 5, 14, 22, 45]

3개 일치 (5,000원) - 1개
4개 일치 (50,000원) - 0개
5개 일치 (1,500,000원) - 0개
5개 일치, 보너스 볼 일치 (30,000,000원) - 0개
6개 일치 (2,000,000,000원) - 0개

총 수익률은 62.5%입니다.
```

중괄호`{}` 안에 있는 내용이 업데이트 되는 영역입니다.

```
{구매한 로또 개수}개를 구매했습니다.

{구매한 로또 목록}

{당첨 개수 통계}
총 수익률은 {수익률}%입니다.
```

* 구매한 로또 개수 화면 업데이트 및 출력
    * [x] 구매한 로또 개수를 파라미터로 받아 화면을 업데이트 합니다.
    * [x] `{구매한 로또 개수}개를 구매했습니다.` 화면을 출력합니다.

* 구매한 로또 목록 화면 업데이트 및 출력
    * [x] 구매한 로또 목록을 파라미터로 받아 화면을 업데이트 합니다.
    * [x] `{구매한 로또 목록}` 화면을 출력합니다.

* 당첨 개수 통계 화면 업데이트 및 출력
    * [x] 당첨 개수 통계를 파라미터로 받아 화면을 업데이트 합니다.
    * [x] `{당첨 개수 통계}` 화면을 출력합니다.

* 수익률 화면 업데이트 및 출력
    * [x] 수익률을 파라미터로 받아 화면을 업데이트 합니다.
    * [x] `총 수익률은 {수익률}%입니다.` 화면을 출력합니다.

### 🌉 controller

#### InputValidator (고정된 기능을 하는 클래스)

사용자 입력(String 타입)을 검증하는 역할을 하는 클래스입니다.

원시 타입으로 할 수 있는 검증을 진행합니다.

* 구입 금액 입력 검증
    * [x] 정수여야 합니다.
    * [x] 양수여야 합니다.
    * [x] 정수로 변환 후, 로또 가격(1000원)으로 나누어 떨어져야 합니다.
* 당첨 번호 입력 검증
    * `,` 단위로 당첨 번호가 구분됩니다.
    * [x] 당첨 번호의 개수는 6개여야 합니다.
    * 당첨 번호를 각각 검증합니다.
        * [x] 정수여야 합니다.
        * [x] 1~45 사이 값이어야 합니다.
    * [x] 당첨 번호 간 숫자가 중복되지 않아야 합니다.
* 보너스 번호 입력 검증
    * [x] 정수여야 합니다.
    * [x] 1~45 사이 값이어야 합니다.

#### InputController (고정된 기능을 하는 클래스)

InputValidator를 이용하여 사용자 입력을 검증하고, 적절한 모델의 타입으로 변환하는 역할을 합니다.

* 구입 금액 입력을 검증합니다.
    * [x] InputValidator를 이용하여 검증을 진행합니다.
    * 올바르지 않은 입력에 대해 에러메세지를 출력하고 재입력을 요구합니다.
        * [x] 에러메세지는 `[Error]`로 시작해야 합니다.
        * [x] 에러메세지 출력 후 재입력을 요구합니다.
* [x] 검증이 끝난 후 구입 금액의 타입을 변환합니다.
    * String -> int

* 당첨 번호 입력을 검증합니다.
    * [x] InputValidator를 이용하여 검증을 진행합니다.
    * 올바르지 않은 입력에 대해 에러메세지를 출력하고 재입력을 요구합니다.
        * [x] 에러메세지는 `[Error]`로 시작해야 합니다.
        * [x] 에러메세지 출력 후 재입력을 요구합니다.
* [x] 검증이 끝난 후 당첨 번호의 타입을 변환합니다.
    * String -> 로또

* 보너스 번호 입력을 검증합니다.
    * [x] InputValidator를 이용하여 검증을 진행합니다.
    * 올바르지 않은 입력에 대해 에러메세지를 출력하고 재입력을 요구합니다.
        * [x] 에러메세지는 `[Error]`로 시작해야 합니다.
        * [x] 에러메세지 출력 후 재입력을 요구합니다.
* [x] 검증이 끝난 후 보너스 번호의 타입을 변환합니다.
    * String -> int

#### OutputController (고정된 기능을 하는 클래스)

각 모델 객체를 사용자 화면에 출력될 문자열로 변환하는 역할을 합니다.

* [x] 구매한 로또 개수 타입을 변환합니다.
    * int -> String
* [x] 구매한 로또 목록 타입을 변환합니다.
    * 로또 목록 타입 -> String
* [x] 당첨 개수 통계 타입을 변환합니다.
    * 당첨 개수 통계 타입 -> String
* [x] 수익률 타입을 변환합니다.
    * double -> String

### 🧑 model

#### 로또

* [x] 로또 번호 목록를 갖고 있습니다.
* 생성자 검증
    * [x] null이 아니어야 합니다.
    * [x] 당첨 번호의 개수는 6이어야 합니다.
    * [x] 1~45 사이 정수여야 합니다.
    * [x] 숫자가 중복되지 않아야 합니다.

#### 당첨 번호 세트(?) (당첨 번호+보너스 번호)

* [x] 당첨 번호와 보너스 번호를 갖고 있습니다.
* 생성자 검증
    * [x] null이 아니어야 합니다.
    * [x] 보너스 번호는 1~45 사이 정수여야 합니다.
    * [x] 보너스 번호와 당첨 번호 사이에 중복된 값이 없어야 합니다.

#### 로또 기계

로또 판매점에서 자동으로 로또 번호를 생성해주는 로또 기계 역할을 하는 클래스입니다.

* [x] 랜덤으로 로또를 1개 생성하는 함수를 갖고 있습니다.
    * [x] 1~45 사이 중복 되지 않은 6개의 수를 뽑아 Lotto 객체를 생성합니다.
    * [x] `camp.nextstep.edu.missionutils.Randoms`의 `pickUniqueNumbersInRange()`를 활용합니다.
* [x] 랜덤으로 로또를 n개 생성해서 반환하는 함수를 갖고 있습니다.
* [x] 로또의 가격을 확인할 수 있습니다.

#### 로또 판매점

로또 판매점 역할을 하는 클래스입니다.

* [x] 로또 기계를 갖고 있습니다.
* [x] 받은 금액만큼 로또를 생성합니다.
* [x] 로또 가격을 확인할 수 있습니다.

#### 로또 구매자

로또 구매자 역할을 하는 클래스입니다.

* [x] 초기 예산을 갖고 있습니다.
* [x] 로또를 구매하는데 사용한 금액을 갖고 있습니다.
* [x] 구매한 로또 목록를 갖고 있습니다.
* [x] 본인이 구매한 로또 목록에 대한 당첨 개수 통계 결과와 수익률 정보를 갖고 있습니다.

* [x] 로또 판매점에서 로또를 구매할 수 있습니다.
* [x] 당첨 번호와 본인이 구매한 로또 목록를 비교하여 당첨 개수 통계를 내고 수익률을 계산할 수 있습니다.

#### 당첨 통계

당첨 통계에 대한 정보를 갖고 있는 역할을 하는 클래스입니다.

* [x] 당첨 번호와 보너스 번호와 당첨을 맞춰볼 로또 번호 목록를 갖고 있습니다.
* [x] 당첨 번호와 보너스 번호를 토대로 계산된 당첨 개수 통계와 수익률 정보를 갖고 있습니다.

### 입출력 흐름

#### 입력 흐름

<img src="./입력 흐름.drawio.png">

#### 출력 흐름

<img src="./출력 흐름.drawio.png">

## 전체 입출력 예시

```
구입금액을 입력해 주세요.
8000

8개를 구매했습니다.
[8, 21, 23, 41, 42, 43] 
[3, 5, 11, 16, 32, 38] 
[7, 11, 16, 35, 36, 44] 
[1, 8, 11, 31, 41, 42] 
[13, 14, 16, 38, 42, 45] 
[7, 11, 30, 40, 42, 43] 
[2, 13, 22, 32, 38, 45] 
[1, 3, 5, 14, 22, 45]

당첨 번호를 입력해 주세요.
1,2,3,4,5,6

보너스 번호를 입력해 주세요.
7

당첨 통계
---
3개 일치 (5,000원) - 1개
4개 일치 (50,000원) - 0개
5개 일치 (1,500,000원) - 0개
5개 일치, 보너스 볼 일치 (30,000,000원) - 0개
6개 일치 (2,000,000,000원) - 0개
총 수익률은 62.5%입니다.
```

---

## 🎯 프로그래밍 요구 사항

### 🔒 라이브러리(?) 제약 사항

- 사용자가 입력하는 값은 `camp.nextstep.edu.missionutils.Console`의 `readLine()`을 활용한다.
- `camp.nextstep.edu.missionutils`에서 제공하는 `Randoms` 및 `Console`
  API를 사용하여 구현해야 한다.
    - Random 값 추출은 `camp.nextstep.edu.missionutils.Randoms`의 `pickUniqueNumbersInRange()`를 활용한다.
- Java Enum을 적용한다.
- 제공된 `Lotto` 클래스를 활용해 구현해야 한다.
    - `numbers`의 접근 제어자인 private을 변경할 수 없다.
    - `Lotto`에 필드(인스턴스 변수)를 추가할 수 없다.
    - `Lotto`의 패키지 변경은 가능하다.

### 컨벤션 제약 사항

- indent(인덴트, 들여쓰기) depth를 3이 넘지 않도록 구현한다. 2까지만 허용한다.
- 3항 연산자를 쓰지 않는다.
- 함수(또는 메서드)의 길이가 15라인을 넘어가지 않도록 구현한다.
- else 예약어를 쓰지 않는다.
    - 힌트: if 조건절에서 값을 return하는 방식으로 구현하면 else를 사용하지 않아도 된다.
    - else를 쓰지 말라고 하니 switch/case로 구현하는 경우가 있는데 switch/case도 허용하지 않는다.

### 테스트 요구 사항

- JUnit 5와 AssertJ를 이용하여 본인이 정리한 기능 목록이 정상 동작함을 테스트 코드로 확인한다.
- 도메인 로직에 단위 테스트를 구현해야 한다. 단, UI(System.out, System.in, Scanner) 로직은 제외한다.
    - 핵심 로직을 구현하는 코드와 UI를 담당하는 로직을 분리해 구현한다.
    - 단위 테스트 작성이 익숙하지 않다면 `test/java/lotto/LottoTest`를 참고하여 학습한 후 테스트를 구현한다.
- 프로그램 구현이 완료되면 ApplicationTest의 모든 테스트가 성공해야 한다. 테스트가 실패할 경우 0점 처리한다.

