미션 - 로또 💰
=

# 🎯 진행 방식

### 게임 규칙
- 로또는 1장 당 1,000원 이다.
- 각각의 로또는 1~45로 이루어진 6개의 숫자이며 `자동 구매` 시스템이다.
- 실제 로또와 동일하게 1~5등이 존재하며 각각의 상금은 정해져있다.

### 게임 진행
- 구매할 금액을 입력한다.(1000원으로 나누어 떨어지지 않는 경우 예외처리)
- `입력된 금액 / 1000`개의 로또를 자동으로 구매한다. (랜덤) 
  - 각각의 로또는 출력 예시와 동일하게 오름차순으로 뽑는다.
- 당첨 번호 6자리를 입력한다.
  - 쉼표(`,`)를 기준으로 6개의 숫자를 입력한다.
- 보너스 번호를 입력한다.
- 당첨 통계를 출력한다.
  - 5,4,3,2,1등 순으로 개수 통계를 구한다.
- 수익률을 출력한다.
  - 초기 구매 금액을 기준으로 수익률을 출력한다.

### 입력
- <U>구입 금액</U>을 `숫자`로 입력한다.
- <U>당첨 번호</U>를 `,`로 구분하여 `문자`로 입력한다.
- <U>보너스 번호</U>를 `숫자`로 입력한다.

### 출력
- 구매
  - `구입금액을 입력해 주세요.` 출력
- 구매 결과
  - `x개를 구매했습니다.` 출력
  - 자동으로 구매한 6자리 로또 n개 출력
- 당첨 번호
  - `당첨 번호를 입력해 주세요.` 출력
- 보너스 번호
  - `보너스 번호를 입력해 주세요.` 출력
- 당첨 통계
  - 등수 별로 몇 개인지 누적한다.
  - 등수는 1등부터 5등 순서대로 체크한 뒤, 이미 당첨된 로또를 다른 등수에 재포함 하지 않도록 한다.
  - 상금은 3자리마다 쉼표를 넣을 수 있도록 `DecimalFormat` 클래스를 활용한다.
  - `당첨통계\n---\n`
  - `x개 일치 (y원) - z개` 등수 별로 출력
- 수익률
  - 수익률은 구매금액 대비 수익률이다. (초기 구입 금액 제외하고 순수 수익만 계산)
  - 최종 수익률은 소수점 둘째 자리에서 반올림한다.
  - `총 수익률은 x%입니다.` 출력


### 요구사항
- 프로그램 종료 시 `System.exit()`으로 강제 종료를 하지 않는다.
- 구현이 완료되면 `ApplicationTest`의 모든 테스트를 성공해야한다.
- 입력은 `Console` 라이브러리를 활용하여 받도록 한다.
- 랜덤 함수의 경우 제공되는 `Randoms` 라이브러리를 활용한다.
  - ex) `List<Integer> numbers = Randoms.pickUniqueNumbersInRange(1, 45, 6);`
- 사용자가 잘못된 값을 입력할 경우 `IllegalArgumentException` 발생 후 종료되어야 한다.
- indent depth는 3이 넘지 않아야 한다. 2까지만 허용된다.
- 메서드가 한 가지 일만 하도록 작게 만든다.
- 테스트를 통해 기능 목록이 정상 작동 됨을 확인한다.
  - 도메인 로직에 단위테스트를 구현한다.
  - 테스트 시 UI로직은 제외한다.
- Enum을 활용한다.
- 제공된 Lotto 클래스를 활용한다.

---

# 🤔 고민해 봐야 할 점

## ✅ 당첨 번호 입력

### 당첨 번호 입력 시 공백을 제거해주어야 할까?
- 예시에서의 당첨 번호는 오직 쉼표(,)로만 구분되어진다.
- 다만, 사용자의 혼동으로 a, b, c 와 같이 공백을 포함할 공산이 있다.
- 이런 경우 엄격하게 예외를 던지기 보다는 보다 유저 친화적으로 처리를 해주고자 한다.
- space(" ")의 경우에는 사용자 착오로 입력될 수 있으므로 `trim()` 메서드를 사용해서 앞뒤 공백을 제거해준다.
  - tab과 같은 공백은 일반적으로 입력되는 공백이 아니므로 제외한다.
  - `strip()`의 경우에는, 유니코드에 포함된 모든 공백들을 제거하므로 사용하지 않기로 하였다.
- 다만, 두 자리 숫자의 경우 숫자 사이에 공백이 존재한다면 이는 오류로 처리해야한다.
  - 이러한 이유 때문에 `replace()` 메서드 대신 `trim()`을 사용하고자 하였다.

### 구입 금액이나 보너스 번호 입력 시 공백을 제거해주어야 할까?
- 결론부터 말하자면 이는 제거하지 않기로 하였다.
- 보다 자세한 에러 메세지를 전달함으로써 입력의 오류 정보를 전달하고자 했다.
- 또한, `[ERROR] 로또 번호는 1부터 45 사이의 숫자여야 합니다.`와 같은 예시가 있기에 엄격하게 숫자만 허용하도록 했다.

## ✅ 당첨 검증

### 당첨 판단을 어떻게 해야할까?
- 먼저 보유한 로또에서 `contains()`로 보너스 번호 보유 여부를 판단한 뒤, boolean으로 플래그를 들고 있는다.
- 이후, 보유한 로또에서 당첨 번호를 `retainAll()`를 활용하여 교집합(일치하는 숫자들)만 남긴다.
- 남은 숫자들을 `size()`를 통해 총 개수를 구한다.
- 이렇게 도출한 `보너스 보유 여부`와 `맞은 개수`를 기반으로 등수를 구한다.

### 통계와 수익률은 어떻게 구해야할까?
- 우선, 구매 이후 자동으로 번호를 뽑은 뒤 repository에 값들을 넣어둔 상태일 것이다.
- 이후, 입력받은 당첨 번호와 보너스 번호를 기반으로 당첨 판단을 통해 당첨 시 각 등수를 누적한다.
  - 등수는 repository에서 관리한다. (`rankCount` -> 배열 형태)
- 이를 기반으로 총 합을 구한 뒤 초기 구매 금액 대비 수익률을 출력한다.

## ✅ 유효성 판단
### 유효성 검증은 컨트롤러에서 해야할까 도메인의 생성자에서 해야할까?
- 생성자는 객체를 초기화하는 부분이다.
- 즉, 객체가 생성되는 순간에 유효한지 판단을 하도록 하고 유효하지 않다면 생성하지 않도록 해야한다.
- 이를 통해 객체의 일관성과 무결성을 보장할 수 있다.
- 즉, 입력 자체에 기본적인 검증은 컨트롤러에서 수행하되, 강력한 검증을 담당하는 부분은 생성자에서 하도록 한다.

## ✅ Enum
### 로또 등수를 Enum으로 다룰 때 어떤 값을 넣어야 할까?
- 기본적으로 맞은 개수와 상금은 넣기로 하였다.
- 추가적으로 보너스볼 보유 여부를 넣을까 고민했지만 2등을 제외하고 보너스볼이 등수에 관여하는 경우는 없다.
  - 예를 들어, 1,4,5 등이 보너스볼을 보유하더라도 등수는 변하지 않는다.
  - 즉, 2, 3등을 제외하고는 보너스볼 보유 여부가 필요한 등수는 없다.
- 그러므로 보너스볼 보유 여부를 필드에 넣기보다는, 모든 등수에 유의미한 값만을 담기 위해 넣지 않기로 하였다.

---

# 🛠️ 기능 목록

## 💡 Main Class

### Application
- [ ] 게임 실행

<br>

## 💡 Domain

### Lotto
- 자동으로 뽑은 숫자를 리스트 형태로 가지고 있는 클래스
- [ ] 6자리 숫자를 담을 `List`를 배치
- [ ] 유효성 검증을 생성자에서 진행

### WinningNumbers
- 로또 당첨 번호와 보너스 번호를 가지고 있는 클래스
- [ ] 6자리 숫자를 담을 `List`와 보너스 번호를 배치
- [ ] 유효성 검증을 생성자에서 진행 

### Grade
- 등수와 관련된 정보를 담은 Enum
- [ ] 등수
- [ ] 맞은 개수
- [ ] 상금
- [ ] 등수 구하는 메서드

<br>

## 💡 DTO
### LottoMatchDto
- [ ] 각각의 로또에 대해서 보너스볼 보유 여부, 일치하는 번호 개수 배치

<br>

## 💡 Controller

### LottoController
- [ ] run 메서드
    - 구입 금액 입력받기
      - 구입 금액 입력 요구 출력
      - view에서 이름 입력받기 + 기본적인 validation
      - <U>자동 구매 결과 저장하기</U>
    - 구매 결과 출력
    - 당첨 번호 입력받기
      - 당첨 번호 입력 요구 출력
      - view에서 당첨번호 입력받기 + validation
      - 보너스 번호 입력 요구 출력
      - view에서 보너스 번호 입력받기 + validation
      - <U>당첨 번호 및 보너스 번호 저장하기</U>
    - 결과 도출하기
- [ ] 로또 결과 도출 메서드
    - 당첨통계 출력
    - 총 수익률 출력

<br>

## 💡 Service

### LottoService
- [ ] 로또 구매 메서드
- [ ] 랜덤으로 로또 번호 6자리를 생성하는 메서드
- [ ] 로또 번호 저장 메서드
- [ ] 당첨 번호 저장 메서드
- [ ] 등수 도출 메서드
- [ ] 통계 저장 메서드
- [ ] 수익률 도출 메서드

<br>

## 💡 Repository

### LottoRepository
- save
  - [ ] 자동 구매한 로또들을 저장하는 `List`
  - [ ] 당첨 로또 번호
  - [ ] 등수 통계
- method
  - [ ] 구매한 로또 저장, 전체 반환
  - [ ] 당첨 로또 저장, 반환
  - [ ] 등수 통계 저장, 반환

<br>

## 💡 View

### InputView
- 입력과 입력에 대한 출력을 담당하는 클래스이다.
- [ ] 구입 금액 입력 질문을 출력하는 메서드
- [ ] 당첨 번호 입력 질문을 출력하는 메서드
- [ ] 입력을 받아서 `숫자`로 이루어진 `List`를 반환하는 메서드
  - 기본적으로 빈 문자열 체크만 하도록 한다.


### OutputView
- 출력을 담당하는 클래스이다.
- [ ] 구매 결과 출력 메서드
- [ ] 당첨 통계 출력 메서드
- [ ] 총 수익률 출력 메서드
- [ ] `OutputConstant`를 활용하여 `System.out.println()`을 통해 출력을 한다.

### InputConstant
- [ ] PRICE_REQUEST : `구입금액을 입력해 주세요.`
- [ ] WINNING_REQUEST : `당첨 번호를 입력해 주세요.`
- [ ] BONUS_REQUEST : `보너스 번호를 입력해 주세요.`
- [ ] INPUT_DELIMITER : `,`

### OutputConstant
- 출력에 필요한 상수들을 담은 Enum 클래스이다.
- [ ] PURCHASE_RESULT : `개를 구매했습니다.`
- [ ] WINNING_RESULT : `당첨 통계\n---`
- [ ] PRIZE_PATTERN : `#,###.#`

<br>

## 💡 Utility

### RandomNumberGenerator
- 난수 생성 역할을 하는 유틸 클래스이다.
- [ ] 난수 생성 메서드

### InputValidation
- 입력의 유효성을 판단하는 클래스이다.
- [ ] 구입 금액 입력 유효성 판단 메서드
  - 숫자 판단
  - 범위 판단 (1000 이상)
  - 1000으로 나누어 떨어지는지 판단
- [ ] 당첨 번호 입력 유효성 판단 메서드
  - 개수 판단
  - 숫자 여부 판단
  - 범위 판단 (1~45)
  - 중복 여부 판단
- [ ] 보너스 입력 유효성 판단 메서드
  - 기존 숫자와 동일한지 판단 (중복 여부)
  - 숫자 여부 판단
  - 범위 판단 (1~45)
- [ ] 유효하지 않은 입력의 경우 `IllegalArgumentException`

<br>

## 💡 Exception

### ErrorMessage
- 에러메세지들을 담을 Enum 클래스이다.
- [ ] 입력 없음 에러 메세지 : `입력을 하지 않았습니다.`
- [ ] 금액 에러 메세지 : ` -> 로또는 1 장당 1000원 입니다. 1000의 배수를 입력해주세요.`
- [ ] 입력 개수 에러 메세지 : ` -> 번호는 6개를 선택해야 합니다.`
- [ ] 범위 에러 메세지 : `-> 1 ~ 45 범위의 자연수만 입력 가능합니다.`
- [ ] 중복 에러 메세지 : ` -> 중복된 번호를 입력할 수 없습니다.`

<br><br>

---

📠 TEST
=

- [ ] 출력 테스트

  <br>

- [ ] 입력값 유효성 테스트  

  <br>

- [ ] 난수 생성 테스트  

  <br>

- [ ] Repository 테스트  

  <br>

- [ ] 결과값 테스트  

  <br>

- [ ] 메인 테스트  

  <br>
